import { GoogleGenerativeAI } from "@google/generative-ai";

const apiKey = process.env.NEXT_PUBLIC_GEMINI_API_KEY;
const genAI = new GoogleGenerativeAI(apiKey!);

const model = genAI.getGenerativeModel({
  model: "gemini-2.0-flash-exp",
});

const generationConfig = {
  temperature: 1,
  topP: 0.95,
  topK: 64,
  maxOutputTokens: 8192,
  responseMimeType: "application/json",
};

export const chatSession = model.startChat({
  generationConfig,
  history: [
    {
      role: "user",
      parts: [
        {
          text: "create kids story on description for 5-8 Years kids, Educational story, and all images in Paper cut style: story of boy and Magic School , give me 5 chapter, With detailed image text prompt for each of chapter and image prompt for story cover book with story name , all in JSON field format\n\n",
        },
      ],
    },
    {
      role: "model",
      parts: [
        {
          text: '```json\n{\n  "bookTitle": "The Boy Who Found the Floating School",\n    "cover": {\n      "imagePrompt": "A whimsical paper cut art style illustration showing a young boy with bright, curious eyes standing in a field of colorful, oversized flowers. Above him, a fantastical schoolhouse floats in the sky, supported by fluffy, pink clouds and sparkling trails. The school is adorned with different sized windows and chimneys with a rainbow smoke. The book title, \'The Boy Who Found the Floating School\', is in large, playful letters at the top of the image. There are birds of paper and star shape cutouts flying around the school. Use bright, primary colors and a layered paper cut style to create a sense of depth.",\n       "altText": "Cover art for \'The Boy Who Found the Floating School\'. A boy looks up at a floating schoolhouse."\n    },\n  "chapters": [\n    {\n      "chapterNumber": 1,\n      "chapterTitle": "The Curious Discovery",\n      "storyText": "Toby loved exploring. One sunny morning, while chasing a bright blue butterfly, he stumbled upon a hidden path. It led him to a clearing heâ€™d never seen before. And there, floating in the sky, was a school! It wasn\'t like any school he knew. It was made of colorful blocks, with windows of different shapes, and fluffy clouds held it up like balloons! ",\n      "imagePrompt": "Paper cut art style illustration showing Toby, a boy with short brown hair and a blue t-shirt, standing in a clearing. He has a surprised expression on his face, looking up with his hand on his forehead for sun protection. The clearing is full of oversized, textured paper cut flowers and tall, green grass blades. Above him, in the clear blue sky, a whimsical schoolhouse is floating, with pink fluffy clouds supporting it. The schoolhouse is made of different colored blocks with various shaped windows,  a chimney with a swirly smoke coming out. Birds and butterfly are flying around the school, all in paper cutout style.",\n      "altText": "Toby discovers a floating school in a clearing.",\n          "educationalNote": "This chapter introduces the concept of curiosity and exploration. Ask the child what they like to explore and where they might find something new."\n    },\n    {\n      "chapterNumber": 2,\n      "chapterTitle": "The Magical Staircase",\n       "storyText": "A shimmering staircase, made of rainbow ribbons, lowered itself from the school. Toby, his heart thumping with excitement, carefully climbed it. Each step felt like walking on cotton candy. The staircase led to a big, round door that sparkled with stars. Taking a deep breath, Toby gently pushed the door open.",\n       "imagePrompt": "Paper cut art illustration. Toby, from the previous chapter, is carefully climbing a staircase made of swirling, layered rainbow-colored ribbons. The staircase is attached to the floating schoolhouse. The schoolhouse is slightly closer and clearer than before. The school has large round sparkly door. The sky is light blue with some white clouds. Everything in layered paper cutout style with a gentle shadow to add depth.",\n       "altText": "Toby climbs the rainbow ribbon staircase to the floating school.",\n          "educationalNote":"This chapter shows the idea of problem solving (using the staircase) to achieve a goal. Ask the child about times they have had to figure out how to do something."\n    },\n      {\n      "chapterNumber": 3,\n      "chapterTitle": "Inside the Wonderful School",\n       "storyText": "Inside, the school was even more magical! The classrooms had tables that changed colors, books that talked, and pencils that drew with sparkles. There were children learning about shapes by building towers of blocks, singing songs about numbers, and painting with invisible colors that only they could see! Toby was amazed!",\n        "imagePrompt": "Paper cut art style. The scene is inside the school. It shows a classroom filled with whimsical and colorful details. There are tables made of paper cut shapes that are changing colors. Some children are building tall paper cut towers of various blocks. Another group is singing from a paper cutout song book, with musical notes floating around them. Some children are painting with invisible paint using sparkly pencils, with some light trails around their paper cutout sketchbooks. Toby, looks around in wonder with open eyes. All items in the image are in a layered paper cutout style with drop shadows to create depth.",\n      "altText": "Inside the magical schoolhouse, children are learning and playing with fantastical supplies.",\n            "educationalNote":"This chapter highlights concepts of shape recognition, counting, music, and art. Ask the child what their favorite subject is and how the school would look different if they were in charge."\n    },\n   {\n      "chapterNumber": 4,\n      "chapterTitle": "Learning to Fly",\n       "storyText": "Toby joined the children. He learned how to write his name with a feather quill that changed color with every letter. Then, they went outside, and the teacher, a kind lady with a hat full of stars, taught them how to fly! They wore paper wings and soared through the air, laughing and playing among the clouds.",\n      "imagePrompt":"Paper cut art style scene depicting the outside of the school, with children wearing paper cut wings of various colors, flying through the sky. A teacher wearing a hat adorned with paper stars is gently guiding them. Toby, wearing bright blue wings, is laughing as he soars among fluffy paper cutout clouds and paper birds. The schoolhouse and rainbow ribbon staircase are visible in the background. Use bright colors and a light, airy feeling.",\n      "altText": "Toby and his classmates learn to fly with paper wings at the magical school.",\n           "educationalNote":"This chapter focuses on literacy (writing names), as well as imagination and physical activity. Discuss what the child would like to learn at the school."\n    },\n    {\n      "chapterNumber": 5,\n      "chapterTitle": "A Special Promise",\n      "storyText": "As the sun began to set, the rainbow staircase lowered again. Toby waved goodbye to his new friends and promised to visit again. He climbed down the staircase, his heart full of joy and wonder. He knew that the magical floating school was a secret just for him. And he couldn\'t wait to see what new adventures awaited him there!",\n      "imagePrompt":"Paper cut art style showing Toby waving goodbye at the rainbow staircase attached to floating school. The sun is setting, coloring the sky in shades of orange and pink. The schoolhouse is now silhouetted against the sunset. The staircase made of rainbow ribbons is visible, leading down to a field of paper cutout flowers. Toby is waving goodbye with a huge smile on his face.  The details are layered to give the scene depth and warm colors to show sunset.",\n      "altText": "Toby says goodbye to his friends at the floating school as the sun sets.",\n      "educationalNote":"This chapter introduces the concept of promises and anticipation. Ask the child how they felt when they saw the magic school and how they felt when Toby had to leave and what they think Toby might learn next."\n   }\n\n  ]\n}\n```\n',
        },
      ],
    },
  ],
});
